\qecho Dylan Nelson
\qecho
\qecho #1
SELECT A.firstname, A.lastname
FROM Author A
	LEFT JOIN BookToAuthor BA ON (A.ID = BA.authorID)
WHERE BA.bookcatID IS NULL
ORDER BY A.ID;
\qecho
\qecho #2
SELECT BC.ID AS id, BC.title
FROM Author A
	JOIN BookToAuthor BA ON (A.ID = BA.authorID)
	RIGHT JOIN BookCat BC ON (BA.bookcatID = BC.ID)
WHERE A.ID IS NULL
ORDER BY BC.ID;
\qecho
\qecho #3
SELECT DISTINCT A.ID
FROM Author A
	JOIN BookToAuthor BA ON (A.ID = BA.authorID)
	JOIN BookCat BC ON (BA.bookcatID = BC.ID)
	JOIN BookCatToGenre BCG ON (BC.ID = BCG.bookcatID)
	JOIN Genre G ON (BCG.genreID = G.ID)
WHERE G.name ILIKE '%Science%'
ORDER BY A.ID;
\qecho
\qecho #4
SELECT COUNT(*) AS "numNonScienceAuthors"
FROM Author A
	LEFT JOIN (
		SELECT A.ID
		FROM Author A
			JOIN BookToAuthor BA ON (A.ID = BA.authorID)
			JOIN BookCat BC ON (BA.bookcatID = BC.ID)
			JOIN BookCatToGenre BCG ON (BC.ID = BCG.bookcatID)
			JOIN Genre G ON (BCG.genreID = G.ID)
		WHERE G.name ILIKE '%Science%'
		) AS Table1 ON (A.ID = Table1.ID)
WHERE Table1.ID IS NULL;
\qecho
\qecho #5
SELECT DISTINCT C.ID, C.firstname, C.lastname
FROM Customer C
	LEFT JOIN LibCard LC ON (C.ID = LC.CustomerID 
					AND LC.isactive = true)
WHERE LC.ID IS NULL
ORDER BY C.ID;
\qecho
\qecho #6
SELECT G.name 
FROM Genre G
	LEFT JOIN BookCatToGenre BCG ON (G.ID = BCG.genreID)
WHERE BCG.genreID IS NULL
ORDER BY G.ID;
\qecho
\qecho #7
SELECT G.name AS genrename, COUNT(BCG.genreID) AS genretotal	
FROM Genre G
	LEFT JOIN BookCatToGenre BCG ON (G.ID = BCG.genreID)
GROUP BY G.ID
ORDER BY genretotal;
\qecho
\qecho #8
SELECT Table1.genre_count, COUNT(*) AS numbooks
FROM (
	SELECT BC.ID AS book_cat, COUNT(BCG.genreID) AS genre_count
	FROM BookCat BC
		LEFT JOIN BookCatToGenre BCG ON (BC.ID = BCG.bookcatID)
	GROUP BY book_cat
	) AS Table1
GROUP BY Table1.genre_count
ORDER BY Table1.genre_count;
\qecho
\qecho #9
SELECT DISTINCT C.ID AS customerID, C.firstname, 
	C.lastname, P.phonetypeID, P.number
FROM Customer C
	JOIN Phone P ON (C.ID = P.customerID)
	LEFT JOIN LibCard LC ON (C.ID = LC.customerID 
					AND LC.isactive = true)
WHERE LC.ID IS NULL
ORDER BY C.ID, P.number;
\qecho
\qecho #10
SELECT DISTINCT C.ID, C.firstname, 
	C.lastname, COALESCE(P.number::text, 'None') AS number
FROM Customer C
	LEFT JOIN Phone P ON (C.ID = P.customerID 
					AND P.phonetypeID = 'C')
	LEFT JOIN LibCard LC ON (C.ID = LC.CustomerID 
					AND LC.isactive = true)
WHERE LC.ID IS NULL
ORDER BY C.ID;
\qecho
\qecho #11A
SELECT COUNT(*) AS numcustomers
FROM Customer;
\qecho
\qecho #11B
SELECT DISTINCT C.ID AS customerid
FROM Customer C
	JOIN LibCard LC ON (C.ID = LC.CustomerID)
        JOIN CORecord CO ON (LC.ID = CO.libcardID)
WHERE CO.codate >= '2022-02-01'
ORDER BY customerid;
\qecho
\qecho #11C
SELECT DISTINCT C.ID
FROM Customer C
	LEFT JOIN LibCard LC ON (C.ID = LC.CustomerID)
        LEFT JOIN CORecord CO ON (LC.ID = CO.libcardID)
GROUP BY C.ID
HAVING MAX(CO.codate) <= '2022-02-01' OR MAX(CO.codate) IS NULL
ORDER BY C.ID;
\qecho
\qecho #12
SELECT BC.ID, BC.title
FROM BookCat BC
	JOIN BookCatToGenre BCG ON (BC.ID = BCG.bookcatID)
	JOIN Genre G ON (BCG.genreID = G.ID)
	LEFT JOIN Book B ON (BC.ID = B.bookcatID)
	LEFT JOIN CORecord CO ON (B.ID = CO.bookID)
WHERE G.name ILIKE 'Computer Science'
GROUP BY BC.ID
HAVING COUNT(CO.ID) = 0
ORDER BY BC.ID;
